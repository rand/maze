direction: right

title: Type Inhabitation Example: User → string {
  near: top-center
  shape: text
  style: {
    font-size: 26
    bold: true
  }
}

subtitle: Finding valid transformation paths {
  near: top-center
  shape: text
  style: {
    font-size: 14
    italic: true
  }
}

user_type: {
  label: "User"
  shape: rectangle
  style: {
    fill: "#1E3A8A"
    stroke: "#1E3A8A"
    stroke-width: 3
    font-color: white
  }

  properties: "Properties:\n• id: string\n• name: string\n• email: string\n• age: number" {
    shape: text
    style.font-size: 12
  }

  methods: "Methods:\n• toString(): string" {
    shape: text
    style.font-size: 12
  }
}

# Valid paths (green)
path1: {
  label: ".id"
  shape: diamond
  style: {
    fill: "#059669"
    stroke: "#059669"
    font-color: white
  }

  type: "Property access\nUser.id → string" {
    shape: text
    style.font-size: 10
  }
}

path2: {
  label: ".name"
  shape: diamond
  style: {
    fill: "#059669"
    stroke: "#059669"
    font-color: white
  }

  type: "Property access\nUser.name → string" {
    shape: text
    style.font-size: 10
  }
}

path3: {
  label: ".email"
  shape: diamond
  style: {
    fill: "#059669"
    stroke: "#059669"
    font-color: white
  }

  type: "Property access\nUser.email → string" {
    shape: text
    style.font-size: 10
  }
}

path4: {
  label: ".toString()"
  shape: diamond
  style: {
    fill: "#D97706"
    stroke: "#D97706"
    font-color: white
  }

  type: "Method call\nUser.toString() → string" {
    shape: text
    style.font-size: 10
  }
}

# Invalid path (red)
invalid_path: {
  label: ".age"
  shape: diamond
  style: {
    fill: "#DC2626"
    stroke: "#DC2626"
    font-color: white
  }

  type: "❌ Type mismatch\nUser.age → number\n(not string)" {
    shape: text
    style.font-size: 10
  }
}

result: {
  label: "string"
  shape: rectangle
  style: {
    fill: "#10B981"
    stroke: "#10B981"
    stroke-width: 4
    font-color: white
    font-size: 18
    bold: true
  }
}

# Connections
user_type -> path1: {
  style: {
    stroke: "#059669"
    stroke-width: 3
  }
}

user_type -> path2: {
  style: {
    stroke: "#059669"
    stroke-width: 3
  }
}

user_type -> path3: {
  style: {
    stroke: "#059669"
    stroke-width: 3
  }
}

user_type -> path4: {
  style: {
    stroke: "#D97706"
    stroke-width: 3
  }
}

user_type -> invalid_path: {
  style: {
    stroke: "#DC2626"
    stroke-width: 2
    stroke-dash: 4
  }
}

path1 -> result: {
  label: "✅ Valid"
  style: {
    stroke: "#059669"
    stroke-width: 3
    font-size: 11
  }
}

path2 -> result: {
  label: "✅ Valid"
  style: {
    stroke: "#059669"
    stroke-width: 3
    font-size: 11
  }
}

path3 -> result: {
  label: "✅ Valid"
  style: {
    stroke: "#059669"
    stroke-width: 3
    font-size: 11
  }
}

path4 -> result: {
  label: "✅ Valid"
  style: {
    stroke: "#D97706"
    stroke-width: 3
    font-size: 11
  }
}

invalid_path -> result: {
  label: "❌ Invalid"
  style: {
    stroke: "#DC2626"
    stroke-width: 2
    stroke-dash: 4
    font-size: 11
  }
}

# Solver annotation
solver: {
  near: bottom-center
  shape: rectangle
  style: {
    fill: "#F3F4F6"
    stroke: "#9CA3AF"
    stroke-width: 2
  }

  title: "Type Inhabitation Solver" {
    shape: text
    style: {
      font-size: 14
      bold: true
    }
  }

  config: "• Search depth: 5\n• Memoized paths\n• Ranked by type fitness" {
    shape: text
    style.font-size: 11
  }

  output: "Generates grammar:\nuser_to_string:\n  user \".\" (\"id\" | \"name\" | \"email\")\n  | user \".\" \"toString\" \"(\" \")\"" {
    shape: rectangle
    style: {
      fill: white
      stroke: "#9CA3AF"
      font-size: 10
    }
  }
}
